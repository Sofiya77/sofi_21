(this["webpackJsonpmaker-code-editor"]=this["webpackJsonpmaker-code-editor"]||[]).push([[22],{1039:function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.FunctionModifierType=void 0,function(e){e.Async="Async",e.Export="Export",e.Declare="Declare"}(r.FunctionModifierType||(r.FunctionModifierType={}))},1040:function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.SignatureParser=void 0;var n=t(650),i=t(944),a=t(946),o=function(){function e(e,r,t){var o=this;void 0===r&&(r="main"),this.targetFunctionName=r,this.parseSignature=function(e){switch(e.kind){case n.SyntaxKind.FunctionDeclaration:return o.parseFunctionDeclaration(e);case n.SyntaxKind.VariableStatement:return o.parseVariableStatement(e);case n.SyntaxKind.VariableDeclaration:return o.parseVariableDeclaration(e);case n.SyntaxKind.Parameter:return o.parseParameterDeclaration(e),!1;default:return!1}};var u=t&&t.compilerOptions&&t.compilerOptions.target||a.SCRIPT_TARGET;this.topNode=i.isSourceFile(e)?e:n.createSourceFile(a.SOURCE_FILE_NAME,e,u,!0,n.ScriptKind.TS)}var r=e.prototype;return r.parse=function(){return!!n.forEachChild(this.topNode,this.parseSignature)},r.parseFunctionDeclaration=function(e){return!!e.name&&this.parseTargetedFunction(e,e.name)},r.parseVariableStatement=function(e){return!!n.forEachChild(e.declarationList,this.parseSignature)},r.parseVariableDeclaration=function(e){var r=e.initializer;return!(!r||!n.isArrowFunction(r))&&this.parseTargetedFunction(r,e.name)},e}();r.SignatureParser=o},1041:function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.parseTypeNode=r.parseType=void 0;var n=t(650),i=t(705),a=t(1353);function o(e,r){var t=u(e.type,r);return n.isParameter(e)&&(t.modifier=a.parseTypeModifier(e,r)),t}function u(e,r){if(!e)return i.createUnrecognizedType();switch(e.kind){case n.SyntaxKind.AnyKeyword:case n.SyntaxKind.UnknownKeyword:return{kind:i.TSType.Any};case n.SyntaxKind.UndefinedKeyword:return{kind:i.TSType.Undefined};case n.SyntaxKind.VoidKeyword:return{kind:i.TSType.Void};case n.SyntaxKind.StringKeyword:return{kind:i.TSType.String};case n.SyntaxKind.ObjectKeyword:return{kind:i.TSType.Object};case n.SyntaxKind.LiteralType:return function(e){switch(e.literal.kind){case n.SyntaxKind.StringLiteral:return{kind:i.TSType.StringLiteral,value:e.literal.text};case n.SyntaxKind.NumericLiteral:return{kind:i.TSType.NumericLiteral,value:+e.literal.text};case n.SyntaxKind.TrueKeyword:case n.SyntaxKind.FalseKeyword:return p(e.literal);default:return i.createUnrecognizedType()}}(e);case n.SyntaxKind.TrueKeyword:case n.SyntaxKind.FalseKeyword:return p(e);case n.SyntaxKind.BooleanKeyword:return{kind:i.TSType.Boolean};case n.SyntaxKind.NumberKeyword:return{kind:i.TSType.Number};case n.SyntaxKind.ArrayType:return function(e,r){return{kind:i.TSType.Array,internalType:u(e.elementType,r)}}(e,r);case n.SyntaxKind.UnionType:return function(e,r){var t=e.types.map((function(e){return u(e,r)}));return{kind:i.TSType.Union,internalTypes:t}}(e,r);case n.SyntaxKind.ParenthesizedType:return u(e.type,r);case n.SyntaxKind.TypeReference:return function(e,r){var t=e.typeName.text?e.typeName.text:e.typeName.getText();if(e.typeArguments){var a=e.typeArguments.map((function(e){return u(e,r)}));return{kind:i.TSType.TypeReference,typeName:t,typeArgs:a}}return function(e,r){var t=i.createUnrecognizedType(),a=function(a){switch(a.kind){case n.SyntaxKind.InterfaceDeclaration:t=function(e,r,t){if(e.name.text!==r)return i.createUnrecognizedType();return s(e.members,t)}(a,e.typeName,r);break;case n.SyntaxKind.TypeAliasDeclaration:t=function(e,r,t){if(e.name.text!==r)return i.createUnrecognizedType();if(n.isTypeAliasDeclaration(e)&&e.type.kind!==n.SyntaxKind.TypeLiteral)return i.createUnrecognizedType();return s(e.type.members,t)}(a,e.typeName,r);break;default:return!1}return t.kind!==i.TSType.Unrecognized};return n.forEachChild(r,a),t.kind!==i.TSType.Unrecognized?t:e}({kind:i.TSType.TypeReference,typeName:t},r)}(e,r);case n.SyntaxKind.TypeLiteral:return function(e,r){var t=e.members.map((function(e){return n.isPropertySignature(e)&&n.isIdentifier(e.name)?{name:e.name.text,type:u(e.type,r)}:{name:"",type:i.createUnrecognizedType()}}));return{kind:i.TSType.TypeLiteral,propertyMembers:t}}(e,r);case n.SyntaxKind.TypeOperator:return u(e.type,r);default:return i.createUnrecognizedType()}}function p(e){return e.kind===n.SyntaxKind.TrueKeyword?{kind:i.TSType.BooleanLiteral,value:!0}:{kind:i.TSType.BooleanLiteral,value:!1}}function s(e,r){var t=e.map((function(e){return{name:e.name.text,type:o(e,r)}}));return{kind:i.TSType.TypeLiteral,propertyMembers:t}}r.parseType=o,r.parseTypeNode=u},1042:function(e,r,t){"use strict";function n(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}Object.defineProperty(r,"__esModule",{value:!0}),r.Validator=void 0;var i=t(941),a=t(1043),o=function(){function e(e){this.parsedNodes=e,this.mErrors=[]}var r,t,o,u=e.prototype;return u.validate=function(){i.isParsedNodesNullObj(this.parsedNodes)||this.doValidate()},u.throwErrors=function(){throw new a.SignatureParserValidationError(this.mErrors)},u.printErrors=function(){console.log(this.mErrors.map((function(e){return JSON.stringify(e,null,2)})).join("\n"))},u.createError=function(r,t,n){t="["+e.ERROR_MESSAGE_DESCRIPTOR+"] "+t,this.mErrors.push({code:r,message:t,position:n})},r=e,(t=[{key:"errors",get:function(){return this.mErrors}}])&&n(r.prototype,t),o&&n(r,o),e}();r.Validator=o,o.ERROR_MESSAGE_DESCRIPTOR="Power automate incompatibility error"},1043:function(e,r,t){"use strict";function n(e){var r="function"===typeof Map?new Map:void 0;return(n=function(e){if(null===e||(t=e,-1===Function.toString.call(t).indexOf("[native code]")))return e;var t;if("function"!==typeof e)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof r){if(r.has(e))return r.get(e);r.set(e,n)}function n(){return i(e,arguments,u(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),o(n,e)})(e)}function i(e,r,t){return(i=a()?Reflect.construct:function(e,r,t){var n=[null];n.push.apply(n,r);var i=new(Function.bind.apply(e,n));return t&&o(i,t.prototype),i}).apply(null,arguments)}function a(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function o(e,r){return(o=Object.setPrototypeOf||function(e,r){return e.__proto__=r,e})(e,r)}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.SignatureParserValidationError=void 0;var p=function(e){var r,t;function n(r){var t;return(t=e.call(this,r.map((function(e){return e.message})).join("\n"))||this).errors=r,Object.setPrototypeOf(function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(t),n.prototype),t}return t=e,(r=n).prototype=Object.create(t.prototype),r.prototype.constructor=r,r.__proto__=t,n}(n(Error));r.SignatureParserValidationError=p},1044:function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.TypeValidator=void 0;var n=t(945),i=t(857),a=t(705),o=function(e){var r,t;function o(r){var t;return(t=e.call(this,r)||this).supportedTypeReferenceTypes=[].concat(n.OBJECT_ARRAY_TYPES),t}t=e,(r=o).prototype=Object.create(t.prototype),r.prototype.constructor=r,r.__proto__=t;var u=o.prototype;return u.addSupportedTypeReferenceTypes=function(){var e;(e=this.supportedTypeReferenceTypes).push.apply(e,arguments)},u.validateType=function(e,r){switch(e.kind){case a.TSType.Any:this.validateAny(e,r);break;case a.TSType.String:case a.TSType.Number:case a.TSType.Boolean:case a.TSType.Undefined:break;case a.TSType.Void:this.validateVoid(e,r);break;case a.TSType.Object:this.validateObject(e,r);break;case a.TSType.Array:this.validateArray(e,r);break;case a.TSType.Union:this.validateUnion(e,r);break;case a.TSType.TypeReference:this.validateTypeReference(e,r);break;case a.TSType.TypeLiteral:this.validateTypeLiteral(e,r);break;case a.TSType.Unrecognized:default:e.kind===a.TSType.Unrecognized?this.createError(i.ValidationTypeErrorCode.UnrecognizableError,this.getErrorLabel()+" Type is unrecognizable",r):this.createError(i.ValidationTypeErrorCode.UnsupportedTypeError,this.getErrorLabel()+" '"+e.kind+"' is not supported",r)}},u.validateAny=function(e,r){this.createError(i.ValidationTypeErrorCode.UnsupportedTypeError,this.getErrorLabel()+" '"+e.kind+"' is not supported",r)},u.validateVoid=function(e,r){this.createError(i.ValidationTypeErrorCode.UnsupportedTypeError,this.getErrorLabel()+" '"+e.kind+"' is not supported",r)},u.validateObject=function(e,r){this.createError(i.ValidationTypeErrorCode.UnsupportedTypeError,this.getErrorLabel()+" '"+e.kind+"' is not supported. Try using an interface or type literal instead",r)},u.validateArray=function(e,r){var t=e.internalType;switch(t.kind){case a.TSType.String:case a.TSType.Number:case a.TSType.Boolean:return;case a.TSType.Union:return void this.validateUnion(t,r);case a.TSType.TypeLiteral:return void this.validateTypeLiteral(t,r);case a.TSType.Array:return void this.validateArray(t,r);case a.TSType.TypeReference:if(n.OBJECT_ARRAY_TYPES.includes(t.typeName)){if(!t.typeArgs)return void this.createError(i.ValidationTypeErrorCode.ArrayTypeError,this.getErrorLabel()+"'"+t.typeName+"' requires type args.",r);var o={kind:a.TSType.Array,internalType:t.typeArgs[0]};return void this.validateArray(o,r)}default:this.createError(i.ValidationTypeErrorCode.ArrayTypeError,this.getErrorLabel()+" '"+t.kind+"' is not a valid array type.",r)}},u.validateUnion=function(e,r){if(a.isOptionalUnionType(e)){var t=a.getNonUndefinedTypes(e)[0];this.validateType(t,r)}},u.validateLiteralUnion=function(e,r){a.isLiteralUnion(e)||this.createError(i.ValidationTypeErrorCode.UnionTypeError,this.getErrorLabel()+" Union type required to be in format 'type | "+a.TSType.Undefined+"' or a union of homogenous literals.",r)},u.validateTypeReference=function(e,r){if(this.supportedTypeReferenceTypes.includes(e.typeName))if(n.OBJECT_ARRAY_TYPES.includes(e.typeName)){if(!e.typeArgs)return void this.createError(i.ValidationTypeErrorCode.TypeReferenceTypeError,this.getErrorLabel()+"'"+e.typeName+"' requires type args.",r);var t={kind:a.TSType.Array,internalType:e.typeArgs[0]};this.validateArray(t,r)}else;else this.createError(i.ValidationTypeErrorCode.TypeReferenceTypeError,this.getErrorLabel()+" Non primitive type '"+e.typeName+"' is not supported.",r)},u.validateTypeLiteral=function(e,r){var t=this;e.propertyMembers.forEach((function(e){switch(e.type.kind){case a.TSType.String:case a.TSType.Number:case a.TSType.Boolean:return;case a.TSType.Array:return void t.validateArray(e.type,r);case a.TSType.Union:return void t.validateUnion(e.type,r);case a.TSType.TypeReference:return void t.validateTypeReference(e.type,r);case a.TSType.TypeLiteral:return void t.validateTypeLiteral(e.type,r);default:t.createError(i.ValidationTypeErrorCode.TypeLiteralTypeError,t.getErrorLabel()+" Type literal contains invalid type '"+e.type.kind+"'.",r)}}))},o}(t(1042).Validator);r.TypeValidator=o},1045:function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.FlowTranslator=void 0;var n=t(945),i=t(705),a=t(765),o=function(){function e(e){this.nodeToTranslate=e}var r=e.prototype;return r.translate=function(){return this.nodeToTranslate?this.translateToFlowNode(this.nodeToTranslate.type):a.createUnrecognizedType()},r.translateToFlowNode=function(e){var r=this.translateToFlowType(e);return Object.assign(r,this.translateModifier(e)),r},r.translateToFlowType=function(e){switch(e.kind){case i.TSType.Any:return{};case i.TSType.String:return{type:a.FlowType.String};case i.TSType.Number:return{type:a.FlowType.Number};case i.TSType.Boolean:return{type:a.FlowType.Boolean};case i.TSType.Object:return this.translateObjectType(e);case i.TSType.Array:return this.translateArrayType(e);case i.TSType.Union:return this.translateUnionType(e);case i.TSType.TypeReference:return this.translateTypeReference(e);case i.TSType.TypeLiteral:return this.translateTypeLiteral(e);default:return a.createUnrecognizedType()}},r.translateObjectType=function(e){return a.createUnrecognizedType()},r.translateArrayType=function(e){return{type:a.FlowType.Array,items:this.translateToFlowType(e.internalType)}},r.translateUnionType=function(e){return a.createUnrecognizedType()},r.translateTypeReference=function(e){var r=e.typeName;return n.OBJECT_ARRAY_TYPES.includes(r)?{type:a.FlowType.Array,items:this.translateTypeReferenceTypeArgs(e)}:a.createUnrecognizedType()},r.translateTypeLiteral=function(e){var r=this;if(e.propertyMembers.length<1)return a.createUnrecognizedType();var t=e.propertyMembers.map((function(e){var t;return(t={})[e.name]=r.translateToFlowType(e.type),t}));return{type:a.FlowType.Object,properties:Object.assign.apply(Object,[{}].concat(t))}},r.translateTypeReferenceTypeArgs=function(e){return e.typeArgs?this.translateToFlowType(e.typeArgs[0]):a.createUnrecognizedType()},r.translateModifier=function(e){if(e.modifier)return e.modifier.kind===i.PropertyModifierType.Default?e.modifier.defaultValue.kind===i.TSType.ArrayLiteral?{default:e.modifier.defaultValue.value.map((function(e){return e.value}))}:{default:e.modifier.defaultValue.value}:void 0},e}();r.FlowTranslator=o},1348:function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.logStats=void 0;var n=t(940),i=t(1349),a=t(1350);r.logStats=function(e){if(null===e)return i.createParameterInfoStats({hasError:!0});if(!e||""===e.trim())return i.createParameterInfoStats();try{var r=JSON.parse(e),t=r.originalParameterOrder.length,o=!n.isFlowReturnSchemaNullObj(r.returnSchema),u=a.sanitizeFlowSchema(r.parameterSchema),p=a.sanitizeFlowSchema(r.returnSchema);return i.createParameterInfoStats({numParams:t,hasReturn:o,paramSchema:u,returnSchema:p})}catch(s){return i.createParameterInfoStats({hasError:!0})}}},1349:function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.createParameterInfoStats=void 0;var n=t(940);r.createParameterInfoStats=function(e){var r=void 0===e?{}:e,t=r.hasError,i=void 0!==t&&t,a=r.numParams,o=void 0===a?0:a,u=r.hasReturn,p=void 0!==u&&u,s=r.paramSchema,c=void 0===s?void 0:s,d=r.returnSchema,y=void 0===d?void 0:d;return i||(c=n.createFlowParameterSchemaNullObj(),y=n.createFlowReturnSchemaNullObj()),{hasError:i,numParams:o,hasReturn:p,paramSchema:c,returnSchema:y}}},1350:function(e,r,t){"use strict";function n(){return(n=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e}).apply(this,arguments)}Object.defineProperty(r,"__esModule",{value:!0}),r.createSanitizedPropertyName=r.sanitizeFlowSchema=void 0;var i=t(765);function a(e){if(e)return e.map((function(e,r){return c(r)}))}function o(e){if(e){var r={};return Object.entries(e).forEach((function(e,t){e[0];var n=e[1];r[c(t)]=u(n)})),r}}function u(e){var r;if(i.isNormalFlowTypeNode(e))switch(e.type){case i.FlowType.String:return n({},e,{default:p(e.default),enum:null===(r=e.enum)||void 0===r?void 0:r.map((function(e){return c()}))});case i.FlowType.Array:return n({},e,{default:s(e.default),items:u(e.items)});case i.FlowType.Object:var t=n({},e);return delete t.properties,t.properties=function(e){if(!e)return;var r={};return Object.entries(e).forEach((function(e,t){e[0];var n=e[1];r[c(t)]=u(n)})),r}(e.properties),t;default:return n({},e)}var a=e.default;return"string"===typeof e.default&&(a=p(e.default)),e.default instanceof Array&&(a=s(e.default)),n({},e,{default:a})}function p(e){return e?c():void 0}function s(e){if(e)return e.every((function(e){return"string"===typeof e}))?e.map((function(e){return c()})):e}function c(e){return"var"+(null!==e&&void 0!==e?e:"")}r.sanitizeFlowSchema=function(e){return n({},e,{required:a(e.required),properties:o(e.properties)})},r.createSanitizedPropertyName=c},1351:function(e,r,t){"use strict";function n(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}Object.defineProperty(r,"__esModule",{value:!0}),r.FunctionSignatureParser=void 0;var i=t(650),a=t(1039),o=t(941),u=t(705),p=t(1040),s=t(1352),c=t(1041),d=function(e){var r,t;function p(r,t,n,i){var a;return void 0===t&&(t="main"),(a=e.call(this,r,t,n)||this).targetFunctionName=t,a.signatureParserOptions=n,a.mParsedNodes=o.createParsedNodesNullObj(),a.typeCheckerStrategy=null!==i&&void 0!==i?i:s.createDefaultNodeTypeChecker,a}t=e,(r=p).prototype=Object.create(t.prototype),r.prototype.constructor=r,r.__proto__=t;var d,y,l,f=p.prototype;return f.parseVariableStatement=function(r){var t=this;return r.modifiers&&r.modifiers.forEach((function(e){return t.parseFunctionModifier(e)})),e.prototype.parseVariableStatement.call(this,r)},f.parseParameterDeclaration=function(e){this.mParsedNodes.paramNodes.push(this.buildParsedNode(e,e.name))},f.parseTargetedFunction=function(e,r){var t=this;return r.text===this.targetFunctionName&&(e.modifiers&&e.modifiers.forEach((function(e){return t.parseFunctionModifier(e)})),this.mParsedNodes.returnNode=this.buildParsedReturnNode(e,r),i.forEachChild(e,this.parseSignature),!0)},f.parseFunctionModifier=function(e){switch(e.kind){case i.SyntaxKind.AsyncKeyword:this.mParsedNodes.functionModifiers=this.mParsedNodes.functionModifiers||[],this.mParsedNodes.functionModifiers.push({kind:a.FunctionModifierType.Async,position:{start:e.pos,end:e.end}});break;case i.SyntaxKind.ExportKeyword:this.mParsedNodes.functionModifiers=this.mParsedNodes.functionModifiers||[],this.mParsedNodes.functionModifiers.push({kind:a.FunctionModifierType.Export,position:{start:e.pos,end:e.end}});break;case i.SyntaxKind.DeclareKeyword:this.mParsedNodes.functionModifiers=this.mParsedNodes.functionModifiers||[],this.mParsedNodes.functionModifiers.push({kind:a.FunctionModifierType.Declare,position:{start:e.pos,end:e.end}})}},f.buildParsedReturnNode=function(e,r){var t=this.buildParsedNode(e,r);return e.type||(t.type=this.getImplicitType(e)),t},f.buildParsedNode=function(e,r){var t=r.text,n={start:r.pos,end:r.end};return{name:t,namePosition:n,type:e.type?c.parseType(e,this.topNode):u.createUnrecognizedType(),typePosition:e.type?{start:e.type.pos,end:e.type.end}:n}},f.getImplicitType=function(e){var r;if(!(null===(r=this.signatureParserOptions)||void 0===r?void 0:r.parseImplicitTypes))return u.createVoidType();var t=this.typeChecker.getSignatureFromDeclaration(e);if(!t)return u.createVoidType();var n=this.typeChecker.getReturnTypeOfSignature(t),i=this.typeChecker.typeToTypeNode(n,void 0,void 0);return c.parseTypeNode(i,this.topNode)},d=p,(y=[{key:"typeChecker",get:function(){var e,r;return this.mTypeChecker||(this.mTypeChecker=this.typeCheckerStrategy(this.topNode,null===(e=this.signatureParserOptions)||void 0===e?void 0:e.libSource,null===(r=this.signatureParserOptions)||void 0===r?void 0:r.compilerOptions)),this.mTypeChecker}},{key:"parsedNodes",get:function(){return this.mParsedNodes}}])&&n(d.prototype,y),l&&n(d,l),p}(p.SignatureParser);r.FunctionSignatureParser=d},1352:function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.createDefaultNodeTypeChecker=void 0;var n=t(650),i=t(946);r.createDefaultNodeTypeChecker=function(e){var r=n.createCompilerHost({}),t={fileExists:function(){return!0},getCanonicalFileName:function(e){return e},getCurrentDirectory:function(){return"/"},getDefaultLibFileName:function(){return"./node_modules/typescript/lib/lib.d.ts"},getNewLine:function(){return"/n"},getSourceFile:function(t){return t===i.SOURCE_FILE_NAME?e:r.getSourceFile(t,i.SCRIPT_TARGET)},readFile:function(){},useCaseSensitiveFileNames:function(){return!1},writeFile:function(){}};return n.createProgram([i.SOURCE_FILE_NAME],{target:i.SCRIPT_TARGET},t).getTypeChecker()}},1353:function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.parseTypeModifier=void 0;var n=t(650),i=t(944),a=t(705),o=t(1041);function u(e){return n.isStringLiteral(e)?{kind:a.TSType.StringLiteral,value:e.text}:n.isNumericLiteral(e)?{kind:a.TSType.NumericLiteral,value:+e.text}:i.isBooleanLiteral(e)?{kind:a.TSType.BooleanLiteral,value:e.kind===n.SyntaxKind.TrueKeyword}:a.createUnrecognizedType()}r.parseTypeModifier=function(e,r){if(void 0!==e.dotDotDotToken)return{kind:a.PropertyModifierType.Rest};if(void 0!==e.questionToken)return{kind:a.PropertyModifierType.Optional};if(void 0!==e.initializer){var t=function(e,r){if(!e.initializer)return a.createUnrecognizedType();if(n.isArrayLiteralExpression(e.initializer)){var t=e.initializer.elements.map((function(e){return u(e)}));return a.isLiteralArray(t)&&e.type?{kind:a.TSType.ArrayLiteral,type:o.parseTypeNode(i.getArrayInnerType(e.type),r),value:t}:a.createUnrecognizedType()}return u(e.initializer)}(e,r);return t.kind!==a.TSType.Unrecognized?{kind:a.PropertyModifierType.Default,defaultValue:t}:a.createUnrecognizedType()}}},1354:function(e,r,t){"use strict";function n(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}Object.defineProperty(r,"__esModule",{value:!0}),r.ParameterOrderSignatureParser=void 0;var i=t(650),a=t(943),o=t(944),u=function(e){var r,t;function u(r,t,n){var i;return void 0===t&&(t="main"),(i=e.call(this,r,t,n)||this).targetFunctionName=t,i.mNodeOrder=[],i.curIndex=0,i.makerApiType=a.MakerApiType.BatchApi,void 0!==n&&(i.makerApiType=n.makerApiType),i}t=e,(r=u).prototype=Object.create(t.prototype),r.prototype.constructor=r,r.__proto__=t;var p,s,c,d=u.prototype;return d.parseParameterDeclaration=function(e){o.isContext(e,this.makerApiType)||this.mNodeOrder.push({name:e.name.text,index:this.curIndex++})},d.parseTargetedFunction=function(e,r){return r.text===this.targetFunctionName&&(i.forEachChild(e,this.parseSignature),!0)},p=u,(s=[{key:"nodeOrder",get:function(){return this.mNodeOrder}}])&&n(p.prototype,s),c&&n(p,c),u}(t(1040).SignatureParser);r.ParameterOrderSignatureParser=u},1355:function(e,r,t){"use strict";function n(){return(n=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e}).apply(this,arguments)}Object.defineProperty(r,"__esModule",{value:!0}),r.createBrowserTypeChecker=void 0;var i=t(650),a=t(946);r.createBrowserTypeChecker=function(e,r,t){void 0===r&&(r=[]),void 0===t&&(t={});var o={fileExists:function(){return!0},getCanonicalFileName:function(e){return e},getCurrentDirectory:function(){return"/"},getDefaultLibFileName:function(){return"lib.ts"},getNewLine:function(){return"\n"},getSourceFile:function(n){if(n===a.SOURCE_FILE_NAME)return e;if("lib.ts"===n){var o="string"===typeof r?r:r.join("\n");return i.createSourceFile(n,o,t.target||a.SCRIPT_TARGET,!0)}},readFile:function(){},useCaseSensitiveFileNames:function(){return!1},writeFile:function(){}};return i.createProgram([a.SOURCE_FILE_NAME],n({target:a.SCRIPT_TARGET},t),o).getTypeChecker()}},1356:function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ModifierValidator=void 0;var n=t(857),i=t(1039),a=function(e){var r,t;function a(r){var t;return(t=e.call(this,r)||this).parsedModifiers=r.functionModifiers,t}t=e,(r=a).prototype=Object.create(t.prototype),r.prototype.constructor=r,r.__proto__=t;var o=a.prototype;return o.doValidate=function(){var e=this;this.parsedModifiers&&this.parsedModifiers.forEach((function(r){r.kind!==i.FunctionModifierType.Async&&e.createError(n.ValidationTypeErrorCode.ModifierError,e.getErrorLabel()+" Function can not have modifier '"+r+"'.",r.position)}))},o.getErrorLabel=function(){return"Modifier error:"},a}(t(1042).Validator);r.ModifierValidator=a},1357:function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ParameterTypeValidator=void 0;var n=t(857),i=t(942),a=t(941),o=t(705),u=function(e){var r,t;function u(r,t){var n;return(n=e.call(this,r)||this).makerApiType=t,n.parsedParameters=[],n.curParam=a.createParsedNodeNullObj(),n.parsedParameters=r.paramNodes,n.addSupportedTypeReferenceTypes(i.getContextType(t)),n}t=e,(r=u).prototype=Object.create(t.prototype),r.prototype.constructor=r,r.__proto__=t;var p=u.prototype;return p.doValidate=function(){var e=this;this.validateContext(),this.parsedParameters.forEach((function(r){e.curParam=r,e.validateType(r.type,r.typePosition)}))},p.getErrorLabel=function(){return a.isParsedNodeNullObj(this.curParam)?"Parameter type error:":"Parameter type error for parameter '"+this.curParam.name+": "+this.curParam.type.kind+"':"},p.validateObject=function(e,r){},p.validateAny=function(e,r){},p.validateArray=function(r,t){var n=r.internalType;n.kind!==o.TSType.Object?e.prototype.validateArray.call(this,r,t):this.validateObject(n,t)},p.validateUnion=function(r,t){o.isOptionalUnionType(r)||this.validateLiteralUnion(r,t),e.prototype.validateUnion.call(this,r,t)},p.validateContext=function(){0!==this.parsedParameters.length&&o.isContext(this.parsedParameters[0],this.makerApiType)||this.createContextError()},p.createContextError=function(){var e=this.parsedParameters.length>0?this.parsedParameters[0].namePosition:this.parsedNodes.returnNode.namePosition;this.createError(n.ValidationTypeErrorCode.ContextError,"Parameter error: First parameter is required to have type: "+i.getContextType(this.makerApiType)+"'",e)},u}(t(1044).TypeValidator);r.ParameterTypeValidator=u},1358:function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ReturnTypeValidator=void 0;var n=t(705),i=function(e){var r,t;function i(r){var t;return(t=e.call(this,r)||this).parsedReturn=r.returnNode,t}t=e,(r=i).prototype=Object.create(t.prototype),r.prototype.constructor=r,r.__proto__=t;var a=i.prototype;return a.doValidate=function(){if(this.parsedReturn){var e=this.isPromiseType(this.parsedReturn.type)?this.parsedReturn.type.typeArgs[0]:this.parsedReturn.type;this.validateType(e,this.parsedReturn.typePosition)}},a.getErrorLabel=function(){return"Return type error:"},a.validateVoid=function(e,r){},a.isPromiseType=function(e){return e.kind===n.TSType.TypeReference&&"Promise"===e.typeName&&void 0!==e.typeArgs&&1===e.typeArgs.length},i}(t(1044).TypeValidator);r.ReturnTypeValidator=i},1359:function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.writeReturnToFlow=r.writeParameterToFlow=void 0;var n=t(1360),i=t(705),a=t(1361),o=t(1362),u=t(940),p=t(765);r.writeParameterToFlow=function(e,r){var t,n=e.map((function(e){var r,t=new a.FlowParameterTranslator(e);return(r={})[e.name]=t.translate(),r})).filter((function(e){return Object.values(e).every((function(e){return!p.containsUnrecognizableFlowType(e)}))}));return 0===n.length?u.createFlowParameterSchemaNullObj():{type:"object",required:function(e,r,t){return r.filter((function(e){return!(void 0!==(r=e.type).modifier&&r.modifier.kind===i.PropertyModifierType.Optional)&&!function(e){return e.kind===i.TSType.Union&&e.internalTypes.map((function(e){return e.kind})).includes(i.TSType.Undefined)}(e.type)&&!i.isContext(e,t);var r})).map((function(e){return e.name})).filter((function(r){return e.includes(r)}))}((t=[]).concat.apply(t,n.map((function(e){return Object.keys(e)}))),e,r),properties:Object.assign.apply(Object,[{}].concat(n))}},r.writeReturnToFlow=function(e){var r,t=new o.FlowReturnTranslator(e).translate();return p.containsUnrecognizableFlowType(t)?u.createFlowReturnSchemaNullObj():{type:"object",properties:(r={},r[n.ROOT_RETURN_PROPERTY_NAME]=t,r)}}},1360:function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ROOT_RETURN_PROPERTY_NAME=void 0,r.ROOT_RETURN_PROPERTY_NAME="result"},1361:function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.FlowParameterTranslator=void 0;var n=t(705),i=t(765),a=function(e){var r,t;function a(){return e.apply(this,arguments)||this}t=e,(r=a).prototype=Object.create(t.prototype),r.prototype.constructor=r,r.__proto__=t;var o=a.prototype;return o.translateObjectType=function(e){return{type:i.FlowType.Object}},o.translateUnionType=function(e){var r=n.getNonUndefinedTypes(e);if(n.isOptionalUnionType(e))return this.translateToFlowType(r[0]);if(n.isLiteralUnion(e))switch(r[0].kind){case n.TSType.StringLiteral:var t=r.map((function(e){return e.value}));return{type:i.FlowType.String,enum:t};case n.TSType.NumericLiteral:var a=r.map((function(e){return e.value}));return{type:i.FlowType.Number,enum:a};case n.TSType.BooleanLiteral:return{type:i.FlowType.Boolean}}return i.createUnrecognizedType()},a}(t(1045).FlowTranslator);r.FlowParameterTranslator=a},1362:function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.FlowReturnTranslator=void 0;var n=t(705),i=t(765),a=function(e){var r,t;function a(){return e.apply(this,arguments)||this}t=e,(r=a).prototype=Object.create(t.prototype),r.prototype.constructor=r,r.__proto__=t;var o=a.prototype;return o.translateUnionType=function(e){var r=n.getNonUndefinedTypes(e);if(n.isOptionalUnionType(e))return this.translateToFlowType(r[0]);if(n.isLiteralUnion(e))switch(r[0].kind){case n.TSType.StringLiteral:return{type:i.FlowType.String};case n.TSType.NumericLiteral:return{type:i.FlowType.Number};case n.TSType.BooleanLiteral:return{type:i.FlowType.Boolean};default:return i.createUnrecognizedType()}return{}},o.translateTypeReference=function(r){return"Promise"===r.typeName?this.translateTypeReferenceTypeArgs(r):e.prototype.translateTypeReference.call(this,r)},a}(t(1045).FlowTranslator);r.FlowReturnTranslator=a},1487:function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.parseTypescriptToFlow=r.ts=r.ValidationTypeErrorCode=r.SignatureParserValidationError=r.MakerApiType=r.logStats=r.FlowType=void 0;var n=t(650);r.ts=n;var i=t(1348);Object.defineProperty(r,"logStats",{enumerable:!0,get:function(){return i.logStats}});var a=t(1351),o=t(1354),u=t(1355),p=t(943);Object.defineProperty(r,"MakerApiType",{enumerable:!0,get:function(){return p.MakerApiType}});var s=t(857);Object.defineProperty(r,"ValidationTypeErrorCode",{enumerable:!0,get:function(){return s.ValidationTypeErrorCode}});var c=t(1356),d=t(1357),y=t(1358),l=t(1043);Object.defineProperty(r,"SignatureParserValidationError",{enumerable:!0,get:function(){return l.SignatureParserValidationError}});var f=t(1359),T=t(765);r.FlowType=T,r.parseTypescriptToFlow=function(e,r,t){void 0===t&&(t="main");var n=new a.FunctionSignatureParser(e,t,r,u.createBrowserTypeChecker);if(!n.parse())throw new l.SignatureParserValidationError([{code:s.ValidationTypeErrorCode.NoTargetFunctionError,message:"No function of name '"+t+"' found. Ensure the function exists and is not nested in anything.",position:{start:0,end:0}}]);var i=new c.ModifierValidator(n.parsedNodes);i.validate();var p=new d.ParameterTypeValidator(n.parsedNodes,r.makerApiType);p.validate();var T=new y.ReturnTypeValidator(n.parsedNodes);T.validate();var v=i.errors.concat(p.errors,T.errors);if(v.length>0)throw new l.SignatureParserValidationError(v);var m=f.writeParameterToFlow(n.parsedNodes.paramNodes,r.makerApiType),h=f.writeReturnToFlow(n.parsedNodes.returnNode),S=new o.ParameterOrderSignatureParser(e,t,r);return S.parse(),{originalParameterOrder:S.nodeOrder,parameterSchema:m,returnSchema:h}}},705:function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.hasDefaultModifier=r.hasRestParameterModifier=r.hasOptionalModifier=r.isContext=r.isLiteralArray=r.isLiteralType=r.isLiteralUnion=r.getNonUndefinedTypes=r.isOptionalUnionType=r.createVoidType=r.createUnrecognizedType=r.PropertyModifierType=r.TSType=void 0;var n,i,a=t(942);function o(e){return e.internalTypes.filter((function(e){return e.kind!==n.Undefined}))}function u(e){return e.kind===n.StringLiteral||e.kind===n.NumericLiteral||e.kind===n.BooleanLiteral||e.kind===n.ArrayLiteral}!function(e){e.Any="Any",e.Undefined="Undefined",e.Void="Void",e.String="String",e.StringLiteral="StringLiteral",e.Boolean="Boolean",e.BooleanLiteral="BooleanLiteral",e.Number="Number",e.NumericLiteral="NumericLiteral",e.Object="Object",e.Array="Array",e.ArrayLiteral="ArrayLiteral",e.Union="Union",e.TypeReference="TypeReference",e.TypeLiteral="TypeLiteral",e.Unrecognized="Unrecognized"}(n=r.TSType||(r.TSType={})),function(e){e.Optional="Optional",e.Rest="Rest",e.Default="Default"}(i=r.PropertyModifierType||(r.PropertyModifierType={})),r.createUnrecognizedType=function(){return{kind:n.Unrecognized}},r.createVoidType=function(){return{kind:n.Void}},r.isOptionalUnionType=function(e){return 2===e.internalTypes.length&&e.internalTypes.some((function(e){return e.kind===n.Undefined}))&&o(e).length>0},r.getNonUndefinedTypes=o,r.isLiteralUnion=function(e){if(e.kind!==n.Union)return!1;var r=o(e);return!(r.length<2)&&(r.every((function(e,r,t){return e.kind===t[0].kind}))&&u(r[0]))},r.isLiteralType=u,r.isLiteralArray=function(e){return e.every((function(e){return u(e)}))},r.isContext=function(e,r){var t=e.type;return t.kind===n.TypeReference&&a.getContextType(r).includes(t.typeName)&&!t.typeArgs},r.hasOptionalModifier=function(e){return void 0!==e.modifier&&e.modifier.kind===i.Optional},r.hasRestParameterModifier=function(e){return void 0!==e.modifier&&e.modifier.kind===i.Rest},r.hasDefaultModifier=function(e){return void 0!==e.modifier&&e.modifier.kind===i.Default}},765:function(e,r,t){"use strict";var n;function i(e){return void 0!==e.type}Object.defineProperty(r,"__esModule",{value:!0}),r.containsUnrecognizableFlowType=r.createUnrecognizedType=r.isNormalFlowTypeNode=r.FlowType=void 0,function(e){e.String="string",e.Number="number",e.Boolean="boolean",e.Array="array",e.Unrecognized="unrecognized",e.Object="object"}(n=r.FlowType||(r.FlowType={})),r.isNormalFlowTypeNode=i,r.createUnrecognizedType=function(){return{type:n.Unrecognized}},r.containsUnrecognizableFlowType=function e(r){if(!i(r))return!1;if(r.type===n.Unrecognized)return!0;switch(r.type){case n.Array:return e(r.items);case n.Object:return!!r.properties&&Object.values(r.properties).some((function(r){return e(r)}));default:return!1}}},857:function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ValidationTypeErrorCode=void 0,function(e){e.UnrecognizableError="UnrecognizableError",e.UnsupportedTypeError="UnsupportedError",e.ArrayTypeError="ArrayTypeError",e.UnionTypeError="UnionTypeError",e.TypeReferenceTypeError="TypeReferenceError",e.TypeLiteralTypeError="TypeLiteralTypeError",e.ContextError="ContextError",e.ModifierError="ModifierError",e.NoTargetFunctionError="NoTargetFunctionError"}(r.ValidationTypeErrorCode||(r.ValidationTypeErrorCode={}))},940:function(e,r,t){"use strict";function n(){return{type:"object",properties:{}}}Object.defineProperty(r,"__esModule",{value:!0}),r.isFlowReturnSchemaNullObj=r.createFlowReturnSchemaNullObj=r.createFlowParameterSchemaNullObj=void 0,r.createFlowParameterSchemaNullObj=function(){return{type:"object",default:{},"x-ms-visibility":"internal"}},r.createFlowReturnSchemaNullObj=n,r.isFlowReturnSchemaNullObj=function(e){return JSON.stringify(e)===JSON.stringify({type:"object",properties:{}})}},941:function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.isParsedNodesNullObj=r.createParsedNodesNullObj=r.isParsedNodeNullObj=r.createParsedNodeNullObj=void 0;var n=t(705);function i(){return{name:"",namePosition:{start:0,end:0},type:n.createUnrecognizedType(),typePosition:{start:0,end:0}}}function a(e){return""===e.name&&0===e.namePosition.start&&0===e.namePosition.end&&e.type.kind===n.TSType.Unrecognized&&0===e.typePosition.start&&0===e.typePosition.end}r.createParsedNodeNullObj=i,r.isParsedNodeNullObj=a,r.createParsedNodesNullObj=function(){return{paramNodes:[],returnNode:i()}},r.isParsedNodesNullObj=function(e){return!e.functionModifiers&&e.paramNodes&&0===e.paramNodes.length&&a(e.returnNode)}},942:function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.getContextType=void 0;var n=t(943);r.getContextType=function(e){switch(void 0===e&&(e=n.MakerApiType.BatchApi),e){case n.MakerApiType.BatchApi:return"Excel.RequestContext";case n.MakerApiType.MakerSyncApi:return"ExcelScript.Workbook";default:return"Excel.RequestContext"}}},943:function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.MakerApiType=void 0,function(e){e.MakerSyncApi="MakerSyncApi",e.BatchApi="BatchApi"}(r.MakerApiType||(r.MakerApiType={}))},944:function(e,r,t){"use strict";function n(e,r){var t;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(t=function(e,r){if(!e)return;if("string"===typeof e)return i(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return i(e,r)}(e))||r&&e&&"number"===typeof e.length){t&&(e=t);var n=0;return function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(t=e[Symbol.iterator]()).next.bind(t)}function i(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}Object.defineProperty(r,"__esModule",{value:!0}),r.getArrayInnerType=r.isContext=r.isBooleanLiteral=r.isAnyKeywordNode=r.isSourceFile=void 0;var a=t(650),o=t(945),u=t(942);function p(e){return e.kind===a.SyntaxKind.AnyKeyword}r.isSourceFile=function(e){return void 0!==e.kind},r.isAnyKeywordNode=p,r.isBooleanLiteral=function(e){return e.kind===a.SyntaxKind.TrueKeyword||e.kind===a.SyntaxKind.FalseKeyword},r.isContext=function(e,r){return a.isParameter(e)&&!!e.type&&a.isTypeReferenceNode(e.type)&&u.getContextType(r).includes(e.type.typeName.text?e.type.typeName.text:e.type.typeName.getText())},r.getArrayInnerType=function e(r){if(p(r))return r;if(a.isArrayTypeNode(r))return r.elementType;if(a.isTypeReferenceNode(r)&&o.OBJECT_ARRAY_TYPES.includes(r.typeName.text)){if(!r.typeArguments)return;return r.typeArguments[0]}if(a.isUnionTypeNode(r))for(var t,i=n(r.types);!(t=i()).done;){var u=e(t.value);if(u)return u}}},945:function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.OBJECT_ARRAY_TYPES=void 0,r.OBJECT_ARRAY_TYPES=["Array","ReadonlyArray"]},946:function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.SCRIPT_TARGET=r.SOURCE_FILE_NAME=void 0;var n=t(650);r.SOURCE_FILE_NAME="index.ts",r.SCRIPT_TARGET=n.ScriptTarget.ES5}}]);
//# sourceMappingURL=parser.ff295bde.chunk.js.map